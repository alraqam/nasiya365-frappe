{
    "services": [
        {
            "type": "app",
            "data": {
                "serviceName": "mariadb",
                "source": {
                    "type": "image",
                    "image": "mariadb:10.6"
                },
                "env": "MYSQL_ROOT_PASSWORD=NasiyaSecure2026\nMYSQL_CHARACTER_SET_SERVER=utf8mb4\nMYSQL_COLLATION_SERVER=utf8mb4_unicode_ci",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "mariadb-data",
                        "mountPath": "/var/lib/mysql"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "redis-cache",
                "source": {
                    "type": "image",
                    "image": "redis:alpine"
                },
                "mounts": [
                    {
                        "type": "volume",
                        "name": "redis-cache-data",
                        "mountPath": "/data"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "redis-queue",
                "source": {
                    "type": "image",
                    "image": "redis:alpine"
                },
                "mounts": [
                    {
                        "type": "volume",
                        "name": "redis-queue-data",
                        "mountPath": "/data"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "backend",
                "source": {
                    "type": "github",
                    "owner": "alraqam",
                    "repo": "nasiya365-frappe",
                    "ref": "main",
                    "path": "/"
                },
                "build": {
                    "type": "dockerfile",
                    "file": "Dockerfile"
                },
                "deploy": {
                    "command": "sh -c 'cd sites && ../env/bin/gunicorn -b 0.0.0.0:8000 -w 4 -t 120 frappe.app:application --preload'"
                },
                "env": "FRAPPE_SITE_NAME_HEADER=my.nasiya365.uz\nDB_HOST=$(PROJECT_NAME)_mariadb\nREDIS_CACHE=$(PROJECT_NAME)_redis-cache:6379\nREDIS_QUEUE=$(PROJECT_NAME)_redis-queue:6379",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    },
                    {
                        "type": "volume",
                        "name": "logs",
                        "mountPath": "/home/frappe/frappe-bench/logs"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "frontend",
                "source": {
                    "type": "image",
                    "image": "frappe/erpnext:v16"
                },
                "deploy": {
                    "command": "nginx-entrypoint.sh"
                },
                "domains": [
                    {
                        "host": "$(EASYPANEL_DOMAIN)",
                        "port": 8080
                    }
                ],
                "env": "BACKEND=$(PROJECT_NAME)_backend:8000\nFRAPPE_SITE_NAME_HEADER=my.nasiya365.uz\nSOCKETIO=$(PROJECT_NAME)_websocket:9000\nUPSTREAM_REAL_IP_ADDRESS=127.0.0.1\nUPSTREAM_REAL_IP_HEADER=X-Forwarded-For\nCLIENT_MAX_BODY_SIZE=50m",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    },
                    {
                        "type": "volume",
                        "name": "logs",
                        "mountPath": "/home/frappe/frappe-bench/logs"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "websocket",
                "source": {
                    "type": "image",
                    "image": "frappe/erpnext:v16"
                },
                "deploy": {
                    "command": "node /home/frappe/frappe-bench/apps/frappe/socketio.js"
                },
                "env": "FRAPPE_SITE_NAME_HEADER=my.nasiya365.uz",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "worker",
                "source": {
                    "type": "github",
                    "owner": "alraqam",
                    "repo": "nasiya365-frappe",
                    "ref": "main",
                    "path": "/"
                },
                "build": {
                    "type": "dockerfile",
                    "file": "Dockerfile"
                },
                "deploy": {
                    "command": "bench worker --queue default"
                },
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    },
                    {
                        "type": "volume",
                        "name": "logs",
                        "mountPath": "/home/frappe/frappe-bench/logs"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "scheduler",
                "source": {
                    "type": "github",
                    "owner": "alraqam",
                    "repo": "nasiya365-frappe",
                    "ref": "main",
                    "path": "/"
                },
                "build": {
                    "type": "dockerfile",
                    "file": "Dockerfile"
                },
                "deploy": {
                    "command": "bench schedule"
                },
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    }
                ]
            }
        }
    ]
}