{
    "services": [
        {
            "type": "mariadb",
            "data": {
                "serviceName": "mariadb",
                "password": "NasiyaSecure2026"
            }
        },
        {
            "type": "redis",
            "data": {
                "serviceName": "redis-cache",
                "password": "NasiyaRedis2026"
            }
        },
        {
            "type": "redis",
            "data": {
                "serviceName": "redis-queue",
                "password": "NasiyaRedis2026"
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "init",
                "source": {
                    "type": "github",
                    "owner": "alraqam",
                    "repo": "nasiya365-frappe",
                    "ref": "main",
                    "path": "/",
                    "autoDeploy": false
                },
                "build": {
                    "type": "dockerfile",
                    "file": "Dockerfile"
                },
                "deploy": {
                    "command": "/home/frappe/init-site.sh",
                    "replicas": 1
                },
                "env": "FRAPPE_SITE_NAME=my.nasiya365.uz\nDB_HOST=mariadb\nDB_ROOT_PASSWORD=NasiyaSecure2026\nADMIN_PASSWORD=admin\nREDIS_CACHE=:NasiyaRedis2026@redis-cache:6379\nREDIS_QUEUE=:NasiyaRedis2026@redis-queue:6379",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    },
                    {
                        "type": "volume",
                        "name": "logs",
                        "mountPath": "/home/frappe/frappe-bench/logs"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "backend",
                "source": {
                    "type": "github",
                    "owner": "alraqam",
                    "repo": "nasiya365-frappe",
                    "ref": "main",
                    "path": "/",
                    "autoDeploy": true
                },
                "build": {
                    "type": "dockerfile",
                    "file": "Dockerfile"
                },
                "deploy": {
                    "command": "sh -c 'bench set-config -g redis_cache redis://$REDIS_CACHE; bench set-config -g redis_queue redis://$REDIS_QUEUE; bench set-config -g redis_socketio redis://$REDIS_QUEUE; cd sites && ../env/bin/gunicorn -b 0.0.0.0:8000 -w 4 -t 120 frappe.app:application --preload'"
                },
                "env": "FRAPPE_SITE_NAME_HEADER=my.nasiya365.uz\nDB_HOST=mariadb\nREDIS_CACHE=:NasiyaRedis2026@redis-cache:6379\nREDIS_QUEUE=:NasiyaRedis2026@redis-queue:6379",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    },
                    {
                        "type": "volume",
                        "name": "logs",
                        "mountPath": "/home/frappe/frappe-bench/logs"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "frontend",
                "source": {
                    "type": "image",
                    "image": "frappe/erpnext:v16"
                },
                "deploy": {
                    "command": "nginx-entrypoint.sh"
                },
                "domains": [
                    {
                        "host": "$(EASYPANEL_DOMAIN)",
                        "port": 8080
                    }
                ],
                "env": "BACKEND=backend:8000\nFRAPPE_SITE_NAME_HEADER=my.nasiya365.uz\nSOCKETIO=websocket:9000\nUPSTREAM_REAL_IP_ADDRESS=127.0.0.1\nUPSTREAM_REAL_IP_HEADER=X-Forwarded-For\nCLIENT_MAX_BODY_SIZE=50m",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    },
                    {
                        "type": "volume",
                        "name": "logs",
                        "mountPath": "/home/frappe/frappe-bench/logs"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "websocket",
                "source": {
                    "type": "image",
                    "image": "frappe/erpnext:v16"
                },
                "deploy": {
                    "command": "sh -c 'bench set-config -g redis_cache redis://$REDIS_CACHE; bench set-config -g redis_queue redis://$REDIS_QUEUE; bench set-config -g redis_socketio redis://$REDIS_QUEUE; node /home/frappe/frappe-bench/apps/frappe/socketio.js'"
                },
                "env": "FRAPPE_SITE_NAME_HEADER=my.nasiya365.uz\nDB_HOST=mariadb\nREDIS_CACHE=:NasiyaRedis2026@redis-cache:6379\nREDIS_QUEUE=:NasiyaRedis2026@redis-queue:6379",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "worker",
                "source": {
                    "type": "github",
                    "owner": "alraqam",
                    "repo": "nasiya365-frappe",
                    "ref": "main",
                    "path": "/",
                    "autoDeploy": true
                },
                "build": {
                    "type": "dockerfile",
                    "file": "Dockerfile"
                },
                "deploy": {
                    "command": "sh -c 'bench set-config -g redis_cache redis://$REDIS_CACHE; bench set-config -g redis_queue redis://$REDIS_QUEUE; bench set-config -g redis_socketio redis://$REDIS_QUEUE; bench worker --queue default'"
                },
                "env": "DB_HOST=mariadb\nREDIS_CACHE=:NasiyaRedis2026@redis-cache:6379\nREDIS_QUEUE=:NasiyaRedis2026@redis-queue:6379",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    },
                    {
                        "type": "volume",
                        "name": "logs",
                        "mountPath": "/home/frappe/frappe-bench/logs"
                    }
                ]
            }
        },
        {
            "type": "app",
            "data": {
                "serviceName": "scheduler",
                "source": {
                    "type": "github",
                    "owner": "alraqam",
                    "repo": "nasiya365-frappe",
                    "ref": "main",
                    "path": "/",
                    "autoDeploy": true
                },
                "build": {
                    "type": "dockerfile",
                    "file": "Dockerfile"
                },
                "deploy": {
                    "command": "sh -c 'bench set-config -g redis_cache redis://$REDIS_CACHE; bench set-config -g redis_queue redis://$REDIS_QUEUE; bench set-config -g redis_socketio redis://$REDIS_QUEUE; bench schedule'"
                },
                "env": "DB_HOST=mariadb\nREDIS_CACHE=:NasiyaRedis2026@redis-cache:6379\nREDIS_QUEUE=:NasiyaRedis2026@redis-queue:6379",
                "mounts": [
                    {
                        "type": "volume",
                        "name": "sites",
                        "mountPath": "/home/frappe/frappe-bench/sites"
                    }
                ]
            }
        }
    ]
}